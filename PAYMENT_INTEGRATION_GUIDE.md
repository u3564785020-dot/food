# Интеграция платёжной системы Emergency Relief Center

## Обзор

Платёжная система Emergency Relief Center успешно интегрирована в приложение BurgerTH. При нажатии кнопки "Оплатить" на странице чекаута клиент перенаправляется на внешнюю платёжную систему с передачей всех необходимых данных.

## Как это работает

### 1. Процесс оплаты

1. Клиент заполняет форму на странице чекаута
2. Нажимает кнопку "Оплатить" 
3. Система валидирует данные формы
4. Генерируется уникальный ID заказа
5. Рассчитывается итоговая сумма (включая доставку)
6. Сумма конвертируется из бат в USD (курс 1 USD = 35 THB)
7. Клиент перенаправляется на платёжную систему Emergency Relief Center

### 2. Передаваемые параметры

- `site`: emergencyrelief.center
- `amount`: сумма в USD
- `symbol`: USD
- `vat`: 20%
- `order_id`: уникальный ID заказа
- `billing_*`: данные клиента (имя, адрес, email, телефон)
- `riderect_success`: URL успешной оплаты
- `riderect_failed`: URL неуспешной оплаты
- `riderect_back`: URL возврата на чекаут

### 3. Обработка результатов

После завершения платежа клиент возвращается на страницу подтверждения заказа с параметрами:
- `status=success` - успешная оплата
- `status=failed` - неуспешная оплата
- `order_id` - ID заказа

## Файлы изменений

### CheckoutPage.jsx
- Обновлена функция `handleProceedToPayment()`
- Добавлена генерация уникального ID заказа
- Добавлена конвертация валют
- Добавлено сохранение данных заказа в localStorage
- Добавлено перенаправление на платёжную систему

### OrderConfirmation.jsx
- Добавлена обработка параметров URL
- Добавлено отображение статуса платежа
- Добавлены разные кнопки действий в зависимости от статуса
- Добавлено отображение ID заказа

### translations.js
- Добавлены переводы для статусов платежа:
  - `paymentSuccessful`
  - `paymentSuccessMessage`
  - `paymentFailed`
  - `paymentFailedMessage`
  - `retryPayment`

### OrderConfirmation.css
- Добавлены стили для статусных иконок
- Добавлены стили для кнопки повторной попытки платежа
- Добавлены стили для отображения ID заказа

## Тестирование

1. Запустите сервер разработки: `npm run dev`
2. Добавьте товары в корзину
3. Перейдите на страницу чекаута
4. Заполните форму
5. Нажмите "Оплатить"
6. Проверьте перенаправление на платёжную систему
7. Проверьте передачу всех параметров

## Важные замечания

- Курс валют зафиксирован как 1 USD = 35 THB (можно изменить в коде)
- Данные заказа сохраняются в localStorage для последующего использования
- При неуспешной оплате клиент может повторить попытку
- Все URL перенаправления используют текущий домен приложения

## Безопасность

- Все данные клиента передаются через HTTPS
- ID заказа генерируется на основе timestamp для уникальности
- Данные заказа сохраняются локально только на время сессии
